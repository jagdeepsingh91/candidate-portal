!function(){angular.module("candidatePortal.application").directive("multipleAutocomplete",["$filter","candidatePortal.services.apiMethods",function(e,r){return{restrict:"EA",scope:{suggestionsArr:"=?",modelArr:"=ngModel",apiUrl:"=",dtoType:"@"},templateUrl:"app/directives/autocomplete/multiple-autocomplete-field/multiple-autocomplete-tpl.html",link:function(t,n,l){t.objectProperty=l.objectProperty,t.selectedItemIndex=0,t.name=l.name,t.isRequired=l.required,t.errMsgRequired=l.errMsgRequired,t.isHover=!1,t.isFocused=!1;var o=function(){var e=t.apiUrl;r.apiGETReq(e,null,!1).then(function(e){"user"==t.dtoType?t.suggestionsArr=e.data.response:t.suggestionsArr=e.data.response},function(e){console.log("Unable to fetch list")})};null!=t.suggestionsArr&&""!=t.suggestionsArr||(null!=t.apiUrl&&""!=t.apiUrl?o():console.log("Please provide suggestion array list or url")),null!=t.modelArr&&""!=t.modelArr||(t.modelArr=[]),t.onFocus=function(){t.isFocused=!0},t.onMouseEnter=function(){t.isHover=!0},t.onMouseLeave=function(){t.isHover=!1},t.onBlur=function(){t.isFocused=!1},t.onChange=function(){t.selectedItemIndex=0},t.keyParser=function(r){var n={38:"up",40:"down",8:"backspace",13:"enter",9:"tab",27:"esc"},l=n[r.keyCode];if("backspace"==l&&""==t.inputValue)0!=t.modelArr.length&&t.modelArr.pop();else if("down"==l){var o=e("filter")(t.suggestionsArr,t.inputValue);o=e("filter")(o,t.alreadyAddedValues),t.selectedItemIndex<o.length-1&&t.selectedItemIndex++}else if("up"==l&&t.selectedItemIndex>0)t.selectedItemIndex--;else if("enter"==l){var o=e("filter")(t.suggestionsArr,t.inputValue);o=e("filter")(o,t.alreadyAddedValues),t.selectedItemIndex<o.length&&t.onSuggestedItemsClick(o[t.selectedItemIndex])}},t.onSuggestedItemsClick=function(e){t.modelArr.push(e),t.inputValue=""};var s=function(e,r){var t=!1;if(null==e||""==e)return t;for(var n=0;n<e.length&&!(t=angular.equals(e[n],r));n++);return t};t.alreadyAddedValues=function(e){var r=!0;return r=!s(t.modelArr,e)},t.removeAddedValues=function(e){if(null!=t.modelArr&&""!=t.modelArr){var r=t.modelArr.indexOf(e);-1!=r&&t.modelArr.splice(r,1)}},t.mouseEnterOnItem=function(e){t.selectedItemIndex=e}}}}])}();